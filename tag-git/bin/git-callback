#!/usr/bin/ruby

def log(msg)
  msg = "[git-callback] #{msg}"
  puts "\e[35m#{msg}\e[0m"
end

def run_ctags
  git_directory = `git rev-parse --git-dir`.chomp
  tags_file_path = "#{git_directory}/tags"

  # Remove the previous `.git/tags` file
  system "rm -f #{tags_file_path}"

  # Generate a new `.git/tags` file
  system "git ls-files | ctags --tag-relative -L - -f'#{tags_file_path}'"

  log "Updated ctags index"
end

run_ctags
